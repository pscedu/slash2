# @bounce_host pscuxa.psc.edu

# @mkcfg DEFINES+=-DPSCLOG_LEVEL=PLL_INFO
# mkcfg DEBUG=0

# @client omnitopia:TMPDIR=/local/tmp:LNET_NETWORKS=sdp4(ib0)
# client polybius:TMPDIR=/local/tmp:LNET_NETWORKS=sdp4(ib0)
# client zebes:TMPDIR=/local/tmp:LNET_NETWORKS=sdp4(ib0)
# client lavos:TMPDIR=/local/tmp:LNET_NETWORKS=sdp4(ib0)

# client yuzu:TMPDIR=/local/tmp:LNET_NETWORKS=sdp4(ib0)
# client kiwi:TMPDIR=/local/tmp:LNET_NETWORKS=sdp4(ib0)

set port=7001;
set net=sdp4;

set pref_mds="md0@SITE0";
set pref_ios="io@SITE0";
set fsuuid="4c0fa37db6e31719";

site @SITE0 {
	site_id			= 0x100;

	resource md0 {
		id		= 0x1;
		type		= mds;
		nids		= polybius-ib0.pvt;

		# @host polybius

		# @fmtcmd umount -f -l /tsuite
		# @fmtcmd rm -rf /tsuite
		# @fmtcmd mkdir -p /tsuite
		# @fmtcmd mount -t tmpfs -o size=12g tmpfs /tsuite
		# @fmtcmd dd if=/dev/zero of=/tsuite/disk bs=1048576 count=10240
		# @fmtcmd touch /tsuite/journal

		# @zpool_args /tsuite/disk
		zpool_name	= tsuite0_s2md;
		journal		= /tsuite/journal;
		# @TMPDIR /local/tmp
	}

	resource io0 {
		type		= standalone_fs;
		id		= 0x10;
		fsroot		= /tsuite/slio;
		nids		= omnitopia-ib0.pvt;
		# @host omnitopia

		# @fmtcmd umount -f -l /tsuite
		# @fmtcmd rm -rf /tsuite
		# @fmtcmd mkdir -p /tsuite
		# @fmtcmd mount -t tmpfs -o size=40G tmpfs /tsuite
		# @fmtcmd mkdir -p /tsuite/slio
		# @TMPDIR /local/tmp
	}

	resource io1 {
		type		= standalone_fs;
		id		= 0x11;
		fsroot		= /tsuite/slio;
		nids		= zebes-ib0.pvt;
		# @host zebes

		# @fmtcmd umount -f -l /tsuite
		# @fmtcmd rm -rf /tsuite
		# @fmtcmd mkdir -p /tsuite
		# @fmtcmd mount -t tmpfs -o size=40G tmpfs /tsuite
		# @fmtcmd mkdir -p /tsuite/slio
		# @TMPDIR /local/tmp
	}

	resource io {
		type		= cluster_noshare_lfs;
		id		= 0x100;
		ios		= io0, io1;
	}
}

#site @site1 {
#	site_id			= 0x101;
#
#	resource md1 {
#		zpool_name	=;
#		journal		= sde;
#		type		= mds;
#		id		= 0x1;
#		nids		= yuzu;
#	}
#
#	resource io0 {
#		type		= standalone_fs;
#		id		= 0x10;
#		fsroot		= /local/slio.tsuite0;
#		nids		= polybius;
#	}
#
#	resource io1 {
#		type		= standalone_fs;
#		id		= 0x11;
#		fsroot		= /local/slio.tsuite0;
#		nids		= zebes;
#	}
#
#	resource io {
#		type		= cluster_noshare_lfs;
#		id		= 0x100;
#		ios		= io0, io1;
#	}
#}
